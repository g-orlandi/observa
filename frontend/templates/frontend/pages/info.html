{% extends "frontend/info_base.html" %}
{% block actual_values %}


<div class="container mt-4">
  <div class="row text-center g-3">

    <div class="row g-3 justify-content-center text-center">

      {% comment %} Beginning of the top line with the actual/instanteneous values {% endcomment %}
      {% for w in widgets %}
        {% comment %} We create a column for every widget {% endcomment %}
      <div class="col-md-{{ w.col|default:2 }}">
        <div class="p-3 bg-light border rounded shadow-sm h-100">
          <div class="text-muted small mb-1">
            <i class="bi {{ w.icon }}"></i> {{ w.title }}
          </div>
          <div class="fs-4 fw-bold text-dark">

            {% comment %} The url is generated dinamically, depending on the metric or not {% endcomment %}
            {% if w.metric %}
              {% url w.url_name metric=w.metric as widget_url %}
            {% else %}
              {% url w.url_name as widget_url %}
            {% endif %}

            {% comment %} Construction of the hx element for retrieve the data {% endcomment %}
            {% if w.source %} {% comment %} This is used only for endpoint {% endcomment %}
              {% with widget_url|add:"?source="|add:w.source as final_url %}
                <span 
                  hx-get="{{ final_url }}" 
                  hx-trigger="{{ w.trigger|default:'load' }}" 
                  hx-swap="outerHTML"
                  class="d-inline-block">
                  ?
                </span>
              {% endwith %}
            {% else %}
              <span 
                hx-get="{{ widget_url }}" 
                hx-trigger="{{ w.trigger|default:'load' }}" 
                hx-swap="outerHTML"
                class="d-inline-block">
                ?
              </span>
            {% endif %}

            {% if w.unit %}
              <small class="text-muted">{{ w.unit }}</small>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}

      {% block other_widgets %}
      
      {% endblock other_widgets %}

    </div>
  </div>
</div>

{% endblock actual_values %}

<hr class="mt-4 mb-3">


{% block charts %}
<div id="graphs-container">
  {% include "frontend/components/graphs.html" %}
</div>
{% endblock charts %}

