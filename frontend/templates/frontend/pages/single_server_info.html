{% extends "frontend/base.html" %}
{% block content %}

<form method="post" action="{% url 'frontend:set_active_server' %}" class="d-flex align-items-center ms-2" style="white-space: nowrap;">
  {% csrf_token %}
  <label for="active-server-select" class="me-2 mb-0 small">Select active server:</label>
  <select id="active-server-select" name="server_id"
          class="form-select form-select-sm py-0 px-1"
          style="height: 30px; font-size: 0.8rem; width: 300px;"
          onchange="this.form.submit()">
    {% for server in user.servers.all %}
      <option value="{{ server.id }}" {% if server.id == user.active_server.id %}selected{% endif %}>
        {{ server }}
      </option>
    {% endfor %}
  </select>
</form>




<div class="container mt-4">
  <div class="row text-center g-3">

    <!-- CPU Usage -->
    <div class="col-md-2">
      <div class="p-3 bg-light border rounded shadow-sm">
        <div class="text-muted text-nowrap">
          <i class="bi bi-cpu"></i> CPU Usage
        </div>
        <div class="fs-3 fw-bold">{{ data.cpu_usage_perc }}%</div>
        <div class="text-success small text-nowrap">
          Live
        </div>
      </div>
    </div>

<!-- Memory -->
<div class="col-md-3">
  <div class="p-3 bg-light border rounded shadow-sm h-100">
    <div class="text-muted text-nowrap">
      <i class="bi bi-memory"></i> Memory used
    </div>
    <div class="fs-4 fw-bold">
      {{ data.memory_used_gb }} GB / {{ data.memory_total_gb }} GB
    </div>
    <div class="text-success small text-nowrap">
      Free: {{ data.memory_free_gb}} GB
    </div>
  </div>
</div>

<!-- Disk -->
<div class="col-md-3">
  <div class="p-3 bg-light border rounded shadow-sm h-100">
    <div class="text-muted text-nowrap">
      <i class="bi bi-hdd-fill"></i> Disk used
    </div>
    <div class="fs-4 fw-bold">
      {{ data.disk_used_gb }} GB / {{ data.disk_total_gb }} GB
    </div>
    <div class="text-success small text-nowrap">
      Free: {{ data.disk_free_gb }} GB
    </div>
  </div>
</div>

    <!-- Server Uptime -->
    <div class="col-md-2">
      <div class="p-3 bg-light border rounded shadow-sm">
        <div class="text-muted text-nowrap">
          <i class="bi bi-clock-history"></i> Uptime
        </div>
        <div class="fs-3 fw-bold">{{ data.server_uptime_days }} days</div>
        <div class="text-info small text-nowrap">
          Since last boot
        </div>
      </div>
    </div>

    <!-- Grafici -->
<div class="container mt-5">
  <div class="row g-4">

    <!-- Grafico CPU -->
    <div class="col-md-6">
      <div class="p-3 bg-white border rounded shadow-sm">
        <h6 class="text-muted">CPU Usage Trend</h6>
        <canvas id="cpuChart" height="150"></canvas>
      </div>
    </div>

    <!-- Grafico Memoria -->
    <div class="col-md-6">
      <div class="p-3 bg-white border rounded shadow-sm">
        <h6 class="text-muted">Memory Usage Trend</h6>
        <canvas id="memoryChart" height="150"></canvas>
      </div>
    </div>

  </div>
</div>


  </div>
</div>
{% endblock content %}
